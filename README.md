# æ¡Œé¢å® ç‰©åº”ç”¨

ä¸€ä¸ªåŸºäº SwiftUI å¼€å‘çš„ macOS æ¡Œé¢å® ç‰©åº”ç”¨ï¼Œæ”¯æŒ AI å¯¹è¯ã€è§’è‰²åˆ‡æ¢ã€éŸ³ä¹æ’­æ”¾ç­‰åŠŸèƒ½ã€‚

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
- [é¡¹ç›®æ¶æ„](#é¡¹ç›®æ¶æ„)
- [æ•°æ®æµåŠ¨](#æ•°æ®æµåŠ¨)
- [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
- [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)

---

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå¯çˆ±çš„æ¡Œé¢å® ç‰©åº”ç”¨ï¼Œå® ç‰©ä¼šæ‚¬æµ®åœ¨æ¡Œé¢ä¸Šï¼Œå¯ä»¥ä¸ç”¨æˆ·è¿›è¡Œ AI å¯¹è¯äº¤äº’ã€‚åº”ç”¨é‡‡ç”¨ MVVM æ¶æ„ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚

### ä¸»è¦ç‰¹æ€§

- ğŸ­ **å¤šè§’è‰²æ”¯æŒ**ï¼šå†…ç½®è§’è‰² + è‡ªå®šä¹‰è§’è‰²ï¼ˆæœ€å¤š3ä¸ªï¼‰
- ğŸ¤– **AI å¯¹è¯**ï¼šæ”¯æŒæ™ºè°±æ¸…è¨€ã€é€šä¹‰åƒé—®ã€Ollama ç­‰å¤šä¸ª AI æœåŠ¡å•†
- ğŸµ **éŸ³ä¹æ’­æ”¾**ï¼šé›†æˆ Apple Music æœç´¢å’Œæ’­æ”¾
- ğŸ¨ **è‡ªå®šä¹‰æ ·å¼**ï¼šå¯è°ƒæ•´ç³»ç»Ÿæç¤ºè¯ã€å¸ƒå±€é‡å åº¦ç­‰
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**ï¼šä½¿ç”¨ UserDefaults ä¿å­˜ç”¨æˆ·è®¾ç½®
- ğŸ¬ **GIF åŠ¨ç”»**ï¼šæ”¯æŒç«™ç«‹å’Œç‚¹å‡»ä¸¤ç§åŠ¨ç”»çŠ¶æ€
- â° **è‡ªåŠ¨äº¤äº’**ï¼šå®šæ—¶è‡ªåŠ¨æ’­æ”¾åŠ¨ç”»å’Œæ˜¾ç¤ºæ¶ˆæ¯

---

## æ ¸å¿ƒåŠŸèƒ½

### 1. å® ç‰©äº¤äº’
- ç‚¹å‡»å® ç‰©è§¦å‘åŠ¨ç”»
- è¾“å…¥æ–‡æœ¬ä¸ AI å¯¹è¯
- æµå¼æ¥æ”¶ AI å“åº”
- å®šæ—¶è‡ªåŠ¨è¡Œä¸ºï¼ˆ5åˆ†é’Ÿå·¦å³éšæœºè§¦å‘ï¼‰

### 2. åå¥½è®¾ç½®
- **é£æ ¼è®¾ç½®**ï¼šç³»ç»Ÿæç¤ºè¯ã€é™æ€æç¤ºè¯åˆ—è¡¨
- **æ¨¡å‹è®¾ç½®**ï¼šAI æœåŠ¡å•†ã€æ¨¡å‹åç§°ã€API åœ°å€ã€API å¯†é’¥
- **å¸ƒå±€è®¾ç½®**ï¼šå¯¹è¯æ¡†ä¸å® ç‰©çš„é‡å æ¯”ä¾‹
- **è§’è‰²ç»‘å®š**ï¼šåˆ‡æ¢å†…ç½®è§’è‰²ã€å¯¼å…¥è‡ªå®šä¹‰è§’è‰²
- **å…³äºé¡µé¢**ï¼šåº”ç”¨ä¿¡æ¯å’Œå½“å‰è§’è‰²

### 3. éŸ³ä¹æ’­æ”¾
- è¯†åˆ«"æˆ‘æƒ³å¬"ã€"æ’­æ”¾"ç­‰å…³é”®è¯
- è‡ªåŠ¨æ‰“å¼€ Apple Music æœç´¢
- æ”¯æŒæ­Œæ›²åç§°æå–

---

## é¡¹ç›®æ¶æ„

### MVVM æ¶æ„æ¨¡å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    View     â”‚â”€â”€â”€â”€â”€â–¶â”‚  ViewModel   â”‚â”€â”€â”€â”€â”€â–¶â”‚    Model    â”‚
â”‚  (SwiftUI)  â”‚â—€â”€â”€â”€â”€â”€â”‚  (Backend)   â”‚â—€â”€â”€â”€â”€â”€â”‚   (Data)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚                      â”‚                      â”‚
      â”‚                      â”‚                      â”‚
      â–¼                      â–¼                      â–¼
  ç”¨æˆ·ç•Œé¢              ä¸šåŠ¡é€»è¾‘              æ•°æ®æ¨¡å‹
```

### æ ¸å¿ƒç»„ä»¶å…³ç³»

```
PetApp (å…¥å£)
    â”‚
    â”œâ”€â–¶ PetView (ä¸»è§†å›¾)
    â”‚       â””â”€â–¶ PetViewBackend (ä¸šåŠ¡é€»è¾‘)
    â”‚               â”œâ”€â–¶ APIManager (AI é€šä¿¡)
    â”‚               â”œâ”€â–¶ MusicPlayerService (éŸ³ä¹æ’­æ”¾)
    â”‚               â””â”€â–¶ GIFDurationCalculator (åŠ¨ç”»æ—¶é•¿)
    â”‚
    â””â”€â–¶ PreferencesView (è®¾ç½®è§†å›¾)
            â””â”€â–¶ PreferencesViewBackend (è®¾ç½®é€»è¾‘)
                    â”œâ”€â–¶ StyleSettingsTab
                    â”œâ”€â–¶ ModelSettingsTab
                    â”œâ”€â–¶ LayoutSettingsTab
                    â”œâ”€â–¶ CharacterBindingTab
                    â””â”€â–¶ AboutTab
```

---

## æ•°æ®æµåŠ¨

### 1. ç”¨æˆ·è¾“å…¥æµç¨‹

```
ç”¨æˆ·è¾“å…¥æ–‡æœ¬
    â”‚
    â–¼
PetView.submitInput()
    â”‚
    â–¼
PetViewBackend.submitInput()
    â”‚
    â”œâ”€â–¶ æ£€æµ‹éŸ³ä¹å…³é”®è¯ï¼Ÿ
    â”‚   â”œâ”€ æ˜¯ â”€â–¶ MusicPlayerService.playSong()
    â”‚   â””â”€ å¦ â”€â–¶ sendRequest()
    â”‚
    â–¼
APIManager.sendStreamRequest()
    â”‚
    â”œâ”€â–¶ æ„å»ºè¯·æ±‚ (buildRequest)
    â”œâ”€â–¶ å‘é€ HTTP è¯·æ±‚
    â””â”€â–¶ æµå¼æ¥æ”¶å“åº”
        â”‚
        â–¼
    è§£æ JSON æ•°æ®
        â”‚
        â–¼
    å›è°ƒ onReceive
        â”‚
        â–¼
    æ›´æ–° streamedResponse
        â”‚
        â–¼
    PetView æ˜¾ç¤ºå“åº”
```

### 2. è®¾ç½®ä¿å­˜æµç¨‹

```
ç”¨æˆ·ä¿®æ”¹è®¾ç½®
    â”‚
    â–¼
PreferencesView ç»‘å®šæ›´æ–°
    â”‚
    â–¼
PreferencesViewBackend.checkUnsavedChanges()
    â”‚
    â–¼
hasUnsavedChanges = true
    â”‚
    â–¼
ç”¨æˆ·ç‚¹å‡»ä¿å­˜
    â”‚
    â–¼
PreferencesViewBackend.saveSettings()
    â”‚
    â”œâ”€â–¶ ä¿å­˜åˆ° @AppStorage (UserDefaults)
    â”œâ”€â–¶ å‘é€é€šçŸ¥ "SettingsChanged"
    â”œâ”€â–¶ æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
    â””â”€â–¶ 2ç§’åå…³é—­çª—å£
```

### 3. è§’è‰²åˆ‡æ¢æµç¨‹

```
ç”¨æˆ·é€‰æ‹©è§’è‰²
    â”‚
    â–¼
CharacterBindingTab.onChange
    â”‚
    â–¼
PreferencesViewBackend.switchCharacter()
    â”‚
    â–¼
PetViewBackend.switchToCharacter()
    â”‚
    â”œâ”€â–¶ æ›´æ–° currentCharacter
    â””â”€â–¶ æ›´æ–° currentGif
        â”‚
        â–¼
    PetView é‡æ–°æ¸²æŸ“
```

### 4. è‡ªåŠ¨è¡Œä¸ºæµç¨‹

```
åº”ç”¨å¯åŠ¨
    â”‚
    â–¼
PetViewBackend.onAppear()
    â”‚
    â–¼
startAutoActionLoop()
    â”‚
    â–¼
scheduleNextAutoAction()
    â”‚
    â–¼
å»¶è¿Ÿ 270-330 ç§’
    â”‚
    â–¼
performAutoAction()
    â”‚
    â”œâ”€â–¶ æ’­æ”¾åŠ¨ç”» (playNextGif)
    â””â”€â–¶ æ˜¾ç¤ºéšæœºæ¶ˆæ¯
        â”‚
        â–¼
    scheduleNextAutoAction() (å¾ªç¯)
```

---

## ç›®å½•ç»“æ„

```
æ¡Œé¢å® ç‰©åº”ç”¨/
â”‚
â”œâ”€â”€ Sources/
â”‚   â”œâ”€â”€ App/
â”‚   â”‚   â””â”€â”€ PetApp.swift                    # åº”ç”¨å…¥å£ï¼Œçª—å£é…ç½®
â”‚   â”‚
â”‚   â”œâ”€â”€ Models/                             # æ•°æ®æ¨¡å‹å±‚
â”‚   â”‚   â”œâ”€â”€ PreferencesData.swift           # è®¾ç½®æ•°æ®ç»“æ„
â”‚   â”‚   â”œâ”€â”€ PreferencesModels.swift         # æ¨¡å‹å…¼å®¹æ–‡ä»¶ï¼ˆå·²é‡æ„ï¼‰
â”‚   â”‚   â”œâ”€â”€ Provider.swift                  # æœåŠ¡å•†æ¨¡å‹
â”‚   â”‚   â””â”€â”€ LayoutConstants.swift           # å¸ƒå±€å¸¸é‡
â”‚   â”‚
â”‚   â”œâ”€â”€ ViewModels/                         # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”‚   â”œâ”€â”€ PetViewBackend.swift            # å® ç‰©è§†å›¾ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ PreferencesViewBackend.swift    # è®¾ç½®è§†å›¾ä¸šåŠ¡é€»è¾‘
â”‚   â”‚
â”‚   â”œâ”€â”€ Views/                              # è§†å›¾å±‚
â”‚   â”‚   â”œâ”€â”€ PetView.swift                   # å® ç‰©ä¸»è§†å›¾
â”‚   â”‚   â””â”€â”€ Preferences/
â”‚   â”‚       â”œâ”€â”€ PreferencesView.swift       # è®¾ç½®ä¸»è§†å›¾
â”‚   â”‚       â”œâ”€â”€ PreferencesTabs/            # è®¾ç½®æ ‡ç­¾é¡µ
â”‚   â”‚       â”‚   â”œâ”€â”€ StyleSettingsTab.swift
â”‚   â”‚       â”‚   â”œâ”€â”€ ModelSettingsTab.swift
â”‚   â”‚       â”‚   â”œâ”€â”€ LayoutSettingsTab.swift
â”‚   â”‚       â”‚   â”œâ”€â”€ CharacterBindingTab.swift
â”‚   â”‚       â”‚   â””â”€â”€ AboutTab.swift
â”‚   â”‚       â””â”€â”€ Components/                 # å¯å¤ç”¨ç»„ä»¶
â”‚   â”‚           â”œâ”€â”€ SystemPromptEditor.swift
â”‚   â”‚           â”œâ”€â”€ ProviderPicker.swift
â”‚   â”‚           â”œâ”€â”€ StaticMessagesEditor.swift
â”‚   â”‚           â”œâ”€â”€ ActionButtons.swift
â”‚   â”‚           â”œâ”€â”€ SuccessBanner.swift
â”‚   â”‚           â”œâ”€â”€ CharacterComponents.swift
â”‚   â”‚           â”œâ”€â”€ LayoutComponents.swift
â”‚   â”‚           â””â”€â”€ ModelInputComponents.swift
â”‚   â”‚
â”‚   â”œâ”€â”€ Services/                           # æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ APIManager.swift                # AI API é€šä¿¡ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ MusicPlayerService.swift        # éŸ³ä¹æ’­æ”¾æœåŠ¡
â”‚   â”‚   â””â”€â”€ GIFDurationCalculator.swift     # GIF æ—¶é•¿è®¡ç®—
â”‚   â”‚
â”‚   â”œâ”€â”€ Utils/                              # å·¥å…·ç±»
â”‚   â”‚   â”œâ”€â”€ MemoryOptimizer.swift           # å†…å­˜ä¼˜åŒ–
â”‚   â”‚   â””â”€â”€ gif_library.swift               # GIF åº“ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
â”‚   â”‚
â”‚   â””â”€â”€ UI/                                 # UI è®¾è®¡ç³»ç»Ÿ
â”‚       â”œâ”€â”€ DesignSystem.swift              # è®¾è®¡ä»¤ç‰Œï¼ˆé¢œè‰²ã€é—´è·ã€åŠ¨ç”»ï¼‰
â”‚       â””â”€â”€ ViewModifiers.swift             # å¯å¤ç”¨è§†å›¾ä¿®é¥°å™¨
â”‚
â”œâ”€â”€ Resources/                              # èµ„æºæ–‡ä»¶
â”‚   â”œâ”€â”€ Animations/                         # GIF åŠ¨ç”»æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ å¤æé›….gif
â”‚   â”‚   â”œâ”€â”€ å¸ƒå¶ç†ŠåŠ¨ä½œé€æ˜.gif
â”‚   â”‚   â””â”€â”€ å¸ƒå¶ç†Šç«™ç«‹é€æ˜.gif
â”‚   â””â”€â”€ Assets.xcassets/                    # åº”ç”¨å›¾æ ‡ç­‰èµ„æº
â”‚
â””â”€â”€ Preview Content/                        # é¢„è§ˆèµ„æº
```

---

## æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **SwiftUI**ï¼šå£°æ˜å¼ UI æ¡†æ¶
- **Combine**ï¼šå“åº”å¼ç¼–ç¨‹æ¡†æ¶
- **AppKit**ï¼šmacOS åŸç”Ÿæ¡†æ¶

### ç¬¬ä¸‰æ–¹åº“
- **SDWebImage**ï¼šGIF åŠ¨ç”»åŠ è½½å’Œç¼“å­˜
- **SDWebImageSwiftUI**ï¼šSwiftUI é›†æˆ

### æ•°æ®å­˜å‚¨
- **UserDefaults**ï¼šè½»é‡çº§é”®å€¼å­˜å‚¨
- **@AppStorage**ï¼šSwiftUI å±æ€§åŒ…è£…å™¨

### ç½‘ç»œé€šä¿¡
- **URLSession**ï¼šHTTP è¯·æ±‚
- **URLSessionDataDelegate**ï¼šæµå¼æ•°æ®æ¥æ”¶

---

## é…ç½®è¯´æ˜

### æ”¯æŒçš„ AI æœåŠ¡å•†

#### 1. æ™ºè°±æ¸…è¨€ (ZhiPu)
```swift
provider: "zhipu"
apiUrl: "https://open.bigmodel.cn/api/paas/v4/chat/completions"
aiModel: "glm-4v-flash"
```

#### 2. é€šä¹‰åƒé—® (Qwen)
```swift
provider: "qwen"
apiUrl: "https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation"
aiModel: "qwen-turbo"
```

#### 3. Ollama (æœ¬åœ°)
```swift
provider: "ollama"
apiUrl: "http://localhost:11434/api/chat"
aiModel: "qwen2.5"
apiKey: "ollama" // ä¸éœ€è¦çœŸå®å¯†é’¥
```

### è‡ªå®šä¹‰è§’è‰²å­˜å‚¨è·¯å¾„

è‡ªå®šä¹‰è§’è‰²çš„ GIF æ–‡ä»¶å­˜å‚¨åœ¨ï¼š
```
~/Library/Application Support/{BundleID}/CustomAnimations/
```

### UserDefaults é”®å

| é”®å | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `apiKey` | String | API å¯†é’¥ |
| `aiModel` | String | AI æ¨¡å‹åç§° |
| `systemPrompt` | String | ç³»ç»Ÿæç¤ºè¯ |
| `apiUrl` | String | API åœ°å€ |
| `provider` | String | æœåŠ¡å•†æ ‡è¯† |
| `overlapRatio` | Double | å¸ƒå±€é‡å æ¯”ä¾‹ |
| `staticMessages` | Data | é™æ€æç¤ºè¯åˆ—è¡¨ï¼ˆJSONï¼‰ |
| `customCharacters` | Data | è‡ªå®šä¹‰è§’è‰²åˆ—è¡¨ï¼ˆJSONï¼‰ |

---

## æ–‡ä»¶èŒè´£è¯´æ˜

### App å±‚
- **PetApp.swift**ï¼šåº”ç”¨å…¥å£ï¼Œé…ç½®ä¸»çª—å£å’Œåå¥½è®¾ç½®çª—å£ï¼Œè®¾ç½®çª—å£æ ·å¼ï¼ˆé€æ˜ã€æ‚¬æµ®ã€æ— è¾¹æ¡†ï¼‰

### Model å±‚
- **PreferencesData.swift**ï¼šå°è£…æ‰€æœ‰è®¾ç½®æ•°æ®ï¼Œæä¾›é»˜è®¤é…ç½®
- **Provider.swift**ï¼šæœåŠ¡å•†æ•°æ®æ¨¡å‹
- **LayoutConstants.swift**ï¼šç»Ÿä¸€çš„å¸ƒå±€å¸¸é‡ï¼ˆé—´è·ã€å°ºå¯¸ã€åœ†è§’ç­‰ï¼‰

### ViewModel å±‚
- **PetViewBackend.swift**ï¼š
  - ç®¡ç†å® ç‰©çŠ¶æ€ï¼ˆå½“å‰è§’è‰²ã€GIFã€ååº”çŠ¶æ€ï¼‰
  - å¤„ç†ç”¨æˆ·äº¤äº’ï¼ˆç‚¹å‡»ã€è¾“å…¥ï¼‰
  - æ§åˆ¶è‡ªåŠ¨è¡Œä¸ºå®šæ—¶å™¨
  - è°ƒç”¨ API æœåŠ¡
  - å†…å­˜ç®¡ç†

- **PreferencesViewBackend.swift**ï¼š
  - ç®¡ç†è®¾ç½®ç•Œé¢çŠ¶æ€
  - éªŒè¯å’Œä¿å­˜è®¾ç½®
  - å¤„ç†è§’è‰²å¯¼å…¥å’Œåˆ é™¤
  - æ£€æµ‹æœªä¿å­˜æ›´æ”¹
  - æä¾›å•†åˆ‡æ¢é€»è¾‘

### View å±‚
- **PetView.swift**ï¼šå® ç‰©ä¸»ç•Œé¢ï¼ŒåŒ…å«è¾“å…¥æ¡†ã€å¯¹è¯è¾“å‡ºã€GIF åŠ¨ç”»
- **PreferencesView.swift**ï¼šè®¾ç½®ä¸»ç•Œé¢ï¼Œä½¿ç”¨ NavigationSplitView å®ç°ä¾§è¾¹æ å¯¼èˆª
- **PreferencesTabs/**ï¼šå„ä¸ªè®¾ç½®æ ‡ç­¾é¡µçš„ç‹¬ç«‹è§†å›¾
- **Components/**ï¼šå¯å¤ç”¨çš„ UI ç»„ä»¶

### Service å±‚
- **APIManager.swift**ï¼š
  - ç®¡ç† AI API é€šä¿¡
  - æ”¯æŒå¤šæœåŠ¡å•†ï¼ˆæ™ºè°±ã€åƒé—®ã€Ollamaï¼‰
  - æµå¼å“åº”å¤„ç†
  - è¯·æ±‚æ„å»ºå’Œé”™è¯¯å¤„ç†

- **MusicPlayerService.swift**ï¼š
  - æå–æ­Œæ›²åç§°
  - æ‰“å¼€ Apple Music æœç´¢

- **GIFDurationCalculator.swift**ï¼š
  - è®¡ç®— GIF æ€»æ’­æ”¾æ—¶é•¿
  - è¯»å–æ¯å¸§å»¶è¿Ÿæ—¶é—´
  - æ”¯æŒå†…ç½®å’Œè‡ªå®šä¹‰ GIF

### Utils å±‚
- **MemoryOptimizer.swift**ï¼š
  - é…ç½® SDWebImage ç¼“å­˜ç­–ç•¥
  - ç›‘å¬å†…å­˜è­¦å‘Š
  - å®šæœŸæ¸…ç†ç¼“å­˜

### UI å±‚
- **DesignSystem.swift**ï¼š
  - é¢œè‰²ç³»ç»Ÿï¼ˆä¸»è¦ã€æ¬¡è¦ã€è¯­ä¹‰ã€çŠ¶æ€ï¼‰
  - é—´è·ç³»ç»Ÿï¼ˆxs, sm, md, lg, xl, xxlï¼‰
  - åŠ¨ç”»é…ç½®ï¼ˆæŒç»­æ—¶é—´ã€ç¼“åŠ¨å‡½æ•°ï¼‰
  - å­—ä½“æ ·å¼

- **ViewModifiers.swift**ï¼š
  - EnhancedTextFieldStyleï¼šæ–‡æœ¬æ¡†ç„¦ç‚¹å’Œæ‚¬åœæ•ˆæœ
  - EnhancedButtonStyleï¼šæŒ‰é’®äº¤äº’åé¦ˆ
  - SmoothScrollStyleï¼šè‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼

---

## å¼€å‘å»ºè®®

### æ·»åŠ æ–°è§’è‰²
1. å‡†å¤‡ç«™ç«‹å’ŒåŠ¨ä½œä¸¤ä¸ª GIF æ–‡ä»¶
2. åœ¨åå¥½è®¾ç½® â†’ è§’è‰²ç»‘å®šä¸­å¯¼å…¥
3. æˆ–åœ¨ä»£ç ä¸­æ·»åŠ åˆ° `availableCharacters` æ•°ç»„

### æ·»åŠ æ–°çš„ AI æœåŠ¡å•†
1. åœ¨ `APIManager.buildRequest()` ä¸­æ·»åŠ æ–°çš„ case
2. åœ¨ `PreferencesViewBackend.handleProviderChange()` ä¸­æ·»åŠ é»˜è®¤é…ç½®
3. åœ¨ `APIManager.urlSession(_:dataTask:didReceive:)` ä¸­æ·»åŠ å“åº”è§£æé€»è¾‘

### è‡ªå®šä¹‰ UI æ ·å¼
1. ä¿®æ”¹ `DesignSystem.swift` ä¸­çš„é¢œè‰²ã€é—´è·ã€åŠ¨ç”»é…ç½®
2. æ‰€æœ‰è§†å›¾ä¼šè‡ªåŠ¨åº”ç”¨æ–°æ ·å¼

### ä¼˜åŒ–å†…å­˜å ç”¨
1. è°ƒæ•´ `MemoryOptimizer` ä¸­çš„ç¼“å­˜å¤§å°é™åˆ¶
2. ä¿®æ”¹å®šæœŸæ¸…ç†çš„æ—¶é—´é—´éš”
3. å‡å°‘ GIF å¸§æ•°æˆ–åˆ†è¾¨ç‡

---

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ å’Œä¸ªäººä½¿ç”¨ã€‚

---

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æäº¤ Issueã€‚
